{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\donia\\\\Documents\\\\Tunisys\\\\src\\\\Contexts\\\\userContext.js\",\n    _s = $RefreshSig$();\n\nimport { createContext, useReducer } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const UsersContext = /*#__PURE__*/createContext();\nexport const usersReducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_USERS':\n      return {\n        users: action.payload\n      };\n\n    case 'CREATE_USER':\n      return {\n        users: [action.payload, ...state.users]\n      };\n\n    case 'UPDATE_USER':\n      const updatedUsers = state.users.map(user => {\n        if (user._id === action.payload._id) {\n          return action.payload;\n        } else {\n          return user;\n        }\n      });\n      return {\n        users: updatedUsers\n      };\n\n    case 'UPDATE_PROFIL':\n      const updatedProfil = state.users.map(user => {\n        if (user._id === action.payload._id) {\n          return action.payload;\n        } else {\n          return user;\n        }\n      });\n      return {\n        users: updatedProfil\n      };\n\n    case 'DELETE_USER':\n      return {\n        users: state.users.filter(u => u._id !== action.payload._id)\n      };\n\n    case 'FETCH_USER_PROFILE':\n      const fetchUserProfile = async () => {\n        var _JSON$parse;\n\n        const email = ((_JSON$parse = JSON.parse(localStorage.getItem('user'))) === null || _JSON$parse === void 0 ? void 0 : _JSON$parse.email) || '';\n\n        if (!email) {\n          return { ...state,\n            error: new Error(\"No email found in localStorage\")\n          };\n        }\n\n        try {\n          const response = await fetch(`/api/user/email/${email}`);\n\n          if (response.ok) {\n            const data = await response.json();\n            return { ...state,\n              user: data,\n              error: null\n            };\n          } else {\n            throw new Error(\"Failed to retrieve user profile data\");\n          }\n        } catch (error) {\n          return { ...state,\n            error\n          };\n        }\n      };\n\n      return fetchUserProfile();\n\n    default:\n      return state;\n  }\n};\nexport const UsersContextProviders = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const [state, dispatch] = useReducer(usersReducer, {\n    users: null\n  });\n  return /*#__PURE__*/_jsxDEV(UsersContext.Provider, {\n    value: { ...state,\n      dispatch\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n};\n\n_s(UsersContextProviders, \"3SYxWWLSmWNqQSSiiXfgeDH14j4=\");\n\n_c = UsersContextProviders;\n\nvar _c;\n\n$RefreshReg$(_c, \"UsersContextProviders\");","map":{"version":3,"names":["createContext","useReducer","UsersContext","usersReducer","state","action","type","users","payload","updatedUsers","map","user","_id","updatedProfil","filter","u","fetchUserProfile","email","JSON","parse","localStorage","getItem","error","Error","response","fetch","ok","data","json","UsersContextProviders","children","dispatch"],"sources":["C:/Users/donia/Documents/Tunisys/src/Contexts/userContext.js"],"sourcesContent":["import { createContext, useReducer } from 'react'\n\nexport const UsersContext = createContext()\n\nexport const usersReducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_USERS':\n      return { \n        users: action.payload \n      }\n    case 'CREATE_USER':\n      return { \n        users: [action.payload, ...state.users] \n      }\n      case 'UPDATE_USER':\n      const updatedUsers = state.users.map(user => {\n        if (user._id === action.payload._id) {\n          return action.payload;\n        } else {\n          return user;\n        }\n      });\n      return { \n        users: updatedUsers\n      }\n      case 'UPDATE_PROFIL':\n      const updatedProfil = state.users.map(user => {\n        if (user._id === action.payload._id) {\n          return action.payload;\n        } else {\n          return user;\n        }\n      });\n      return { \n        users: updatedProfil\n      }\n    case 'DELETE_USER':\n      return { \n        users: state.users.filter(u => u._id !== action.payload._id) \n      }\n      case 'FETCH_USER_PROFILE':\n        const fetchUserProfile = async () => {\n          const email = JSON.parse(localStorage.getItem('user'))?.email || '';\n          if (!email) {\n            return { ...state, error: new Error(\"No email found in localStorage\") };\n          }\n      \n          try {\n            const response = await fetch(`/api/user/email/${email}`);\n            if (response.ok) {\n              const data = await response.json();\n              return { ...state, user: data, error: null };\n            } else {\n              throw new Error(\"Failed to retrieve user profile data\");\n            }\n          } catch (error) {\n            return { ...state, error };\n          }\n        };\n      \n        return fetchUserProfile();\n      \n    \n    default:\n      return state\n  }\n}\n\nexport const UsersContextProviders = ({ children }) => {\n  const [state, dispatch] = useReducer(usersReducer, { \n    users: null\n  })\n  \n  return (\n    <UsersContext.Provider value={{...state, dispatch }}>\n      { children }\n    </UsersContext.Provider>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}